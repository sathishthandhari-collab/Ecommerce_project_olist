{"timestamp":"2025-10-11T23:10:19.996524Z","level":"info","event":"DAG bundles loaded: dags-folder, example_dags","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager","filename":"manager.py","lineno":179}
{"timestamp":"2025-10-11T23:10:19.999484Z","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/olist_production_dag.py","logger":"airflow.models.dagbag.DagBag","filename":"dagbag.py","lineno":593}
{"timestamp":"2025-10-11T23:10:20.314229Z","level":"info","event":"Task instance is in running state","logger":"task.stdout"}
{"timestamp":"2025-10-11T23:10:20.315136Z","level":"info","event":" Previous state of the Task instance: TaskInstanceState.QUEUED","logger":"task.stdout"}
{"timestamp":"2025-10-11T23:10:20.319491Z","level":"info","event":"Current task name:data_quality_tests.check_data_freshness","logger":"task.stdout"}
{"timestamp":"2025-10-11T23:10:20.320897Z","level":"info","event":"Dag name:olist_production_pipeline","logger":"task.stdout"}
{"timestamp":"2025-10-11T23:10:20.314434Z","level":"info","event":"Tmp dir root location: /tmp","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":78}
{"timestamp":"2025-10-11T23:10:20.316938Z","level":"info","event":"Running command: ['/usr/bin/bash', '-c', '\\n        export PATH=/home/airflow/.local/bin:$PATH &&\\n        cd /opt/airflow/dags/olist_dbt_transformation &&\\n        dbt source freshness --profiles-dir . --project-dir . --target prod\\n        ']","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":88}
{"timestamp":"2025-10-11T23:10:20.352513Z","level":"info","event":"Output:","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":99}
{"timestamp":"2025-10-11T23:10:26.971838Z","level":"info","event":"\u001b[0m23:10:26  Running with dbt=1.10.13","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":106}
{"timestamp":"2025-10-11T23:10:29.987836Z","level":"info","event":"\u001b[0m23:10:29  Registered adapter: snowflake=1.10.2","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":106}
{"timestamp":"2025-10-11T23:10:37.886758Z","level":"info","event":"\u001b[0m23:10:37  [\u001b[33mWARNING\u001b[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":106}
{"timestamp":"2025-10-11T23:10:37.887144Z","level":"info","event":"There are 9 unused configuration paths:","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":106}
{"timestamp":"2025-10-11T23:10:37.887274Z","level":"info","event":"- models.olist_dbt_transformation.marts.operations.mart_logistics_performance","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":106}
{"timestamp":"2025-10-11T23:10:37.887655Z","level":"info","event":"- models.olist_dbt_transformation.marts.finance.marts_payment_method_performance","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":106}
{"timestamp":"2025-10-11T23:10:37.887873Z","level":"info","event":"- models.olist_dbt_transformation.marts.operations.mart_fraud_monitoring","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":106}
{"timestamp":"2025-10-11T23:10:37.888042Z","level":"info","event":"- models.olist_dbt_transformation.marts.operations.mart_seller_management","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":106}
{"timestamp":"2025-10-11T23:10:37.888157Z","level":"info","event":"- models.olist_dbt_transformation.marts.finance.marts_unit_economics","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":106}
{"timestamp":"2025-10-11T23:10:37.888289Z","level":"info","event":"- seeds.olist_analytics","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":106}
{"timestamp":"2025-10-11T23:10:37.888426Z","level":"info","event":"- data_tests.olist_dbt_transformation.generic.expect_foreign_key_relationships_with_context","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":106}
{"timestamp":"2025-10-11T23:10:37.888573Z","level":"info","event":"- data_tests.olist_dbt_transformation.generic.expect_z_score_within","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":106}
{"timestamp":"2025-10-11T23:10:37.888722Z","level":"info","event":"- data_tests.olist_dbt_transformation.generic.expect_column_pair_values_A_to_be_smaller_than_B","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":106}
{"timestamp":"2025-10-11T23:10:39.527194Z","level":"info","event":"\u001b[0m23:10:39  Found 21 models, 3 snapshots, 1 analysis, 3 operations, 113 data tests, 8 sources, 905 macros","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":106}
{"timestamp":"2025-10-11T23:10:39.541571Z","level":"info","event":"\u001b[0m23:10:39","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":106}
{"timestamp":"2025-10-11T23:10:39.543376Z","level":"info","event":"\u001b[0m23:10:39  Concurrency: 8 threads (target='prod')","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":106}
{"timestamp":"2025-10-11T23:10:39.545154Z","level":"info","event":"\u001b[0m23:10:39","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":106}
{"timestamp":"2025-10-11T23:10:45.072938Z","level":"info","event":"\u001b[0m23:10:45  === Starting dbt run in {'account': 'JVQRMFM-GKB40702', 'user': 'sathishthandhari', 'database': 'olist_prod', 'warehouse': 'projects', 'role': 'accountadmin', 'schema': 'staging', 'authenticator': None, 'oauth_client_id': None, 'query_tag': None, 'client_session_keep_alive': False, 'host': None, 'port': None, 'proxy_host': None, 'proxy_port': None, 'protocol': None, 'connect_retries': 1, 'connect_timeout': None, 'retry_on_database_errors': False, 'retry_all': False, 'insecure_mode': False, 'reuse_connections': True, 's3_stage_vpce_dns_name': None, 'type': 'snowflake', 'threads': 8, 'name': 'prod', 'target_name': 'prod', 'profile_name': 'olist_dbt_transformation'} environment ===","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":106}
{"timestamp":"2025-10-11T23:10:45.087642Z","level":"info","event":"\u001b[0m23:10:45  1 of 2 START hook: olist_dbt_transformation.on-run-start.0 ..................... [RUN]","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":106}
{"timestamp":"2025-10-11T23:10:45.089945Z","level":"info","event":"\u001b[0m23:10:45  1 of 2 OK hook: olist_dbt_transformation.on-run-start.0 ........................ [\u001b[32mOK\u001b[0m in 0.04s]","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":106}
{"timestamp":"2025-10-11T23:10:45.101540Z","level":"info","event":"\u001b[0m23:10:45  Production run: processing full datasets","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":106}
{"timestamp":"2025-10-11T23:10:45.119437Z","level":"info","event":"\u001b[0m23:10:45  2 of 2 START hook: olist_dbt_transformation.on-run-start.1 ..................... [RUN]","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":106}
{"timestamp":"2025-10-11T23:10:45.121927Z","level":"info","event":"\u001b[0m23:10:45  2 of 2 OK hook: olist_dbt_transformation.on-run-start.1 ........................ [\u001b[32mOK\u001b[0m in 0.03s]","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":106}
{"timestamp":"2025-10-11T23:10:45.124091Z","level":"info","event":"\u001b[0m23:10:45","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":106}
{"timestamp":"2025-10-11T23:10:45.126294Z","level":"info","event":"\u001b[0m23:10:45  Pulling freshness from warehouse metadata tables for 8 sources","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":106}
{"timestamp":"2025-10-11T23:10:47.668271Z","level":"info","event":"\u001b[0m23:10:47  1 of 8 START freshness of src_olist_raw.raw_olist_customers .................... [RUN]","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":106}
{"timestamp":"2025-10-11T23:10:47.673973Z","level":"info","event":"\u001b[0m23:10:47  2 of 8 START freshness of src_olist_raw.raw_olist_geolocation .................. [RUN]","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":106}
{"timestamp":"2025-10-11T23:10:47.679429Z","level":"info","event":"\u001b[0m23:10:47  3 of 8 START freshness of src_olist_raw.raw_olist_order_items .................. [RUN]","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":106}
{"timestamp":"2025-10-11T23:10:47.684427Z","level":"info","event":"\u001b[0m23:10:47  4 of 8 START freshness of src_olist_raw.raw_olist_orders ....................... [RUN]","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":106}
{"timestamp":"2025-10-11T23:10:47.686394Z","level":"info","event":"\u001b[0m23:10:47  5 of 8 START freshness of src_olist_raw.raw_olist_payments ..................... [RUN]","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":106}
{"timestamp":"2025-10-11T23:10:47.690487Z","level":"info","event":"\u001b[0m23:10:47  6 of 8 START freshness of src_olist_raw.raw_olist_products ..................... [RUN]","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":106}
{"timestamp":"2025-10-11T23:10:47.693104Z","level":"info","event":"\u001b[0m23:10:47  7 of 8 START freshness of src_olist_raw.raw_olist_reviews ...................... [RUN]","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":106}
{"timestamp":"2025-10-11T23:10:47.695680Z","level":"info","event":"\u001b[0m23:10:47  8 of 8 START freshness of src_olist_raw.raw_olist_sellers ...................... [RUN]","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":106}
{"timestamp":"2025-10-11T23:10:47.748657Z","level":"info","event":"\u001b[0m23:10:47  1 of 8 ERROR STALE freshness of src_olist_raw.raw_olist_customers .............. [\u001b[31mERROR STALE\u001b[0m in 0.06s]","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":106}
{"timestamp":"2025-10-11T23:10:47.755249Z","level":"info","event":"\u001b[0m23:10:47  4 of 8 WARN freshness of src_olist_raw.raw_olist_orders ........................ [\u001b[33mWARN\u001b[0m in 0.05s]","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":106}
{"timestamp":"2025-10-11T23:10:47.771789Z","level":"info","event":"\u001b[0m23:10:47  7 of 8 ERROR STALE freshness of src_olist_raw.raw_olist_reviews ................ [\u001b[31mERROR STALE\u001b[0m in 0.06s]","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":106}
{"timestamp":"2025-10-11T23:10:47.780594Z","level":"info","event":"\u001b[0m23:10:47  8 of 8 ERROR STALE freshness of src_olist_raw.raw_olist_sellers ................ [\u001b[31mERROR STALE\u001b[0m in 0.06s]","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":106}
{"timestamp":"2025-10-11T23:10:47.794791Z","level":"info","event":"\u001b[0m23:10:47  2 of 8 ERROR STALE freshness of src_olist_raw.raw_olist_geolocation ............ [\u001b[31mERROR STALE\u001b[0m in 0.09s]","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":106}
{"timestamp":"2025-10-11T23:10:47.808439Z","level":"info","event":"\u001b[0m23:10:47  6 of 8 ERROR STALE freshness of src_olist_raw.raw_olist_products ............... [\u001b[31mERROR STALE\u001b[0m in 0.10s]","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":106}
{"timestamp":"2025-10-11T23:10:47.839293Z","level":"info","event":"\u001b[0m23:10:47  5 of 8 ERROR STALE freshness of src_olist_raw.raw_olist_payments ............... [\u001b[31mERROR STALE\u001b[0m in 0.15s]","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":106}
{"timestamp":"2025-10-11T23:10:47.850689Z","level":"info","event":"\u001b[0m23:10:47  3 of 8 ERROR STALE freshness of src_olist_raw.raw_olist_order_items ............ [\u001b[31mERROR STALE\u001b[0m in 0.15s]","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":106}
{"timestamp":"2025-10-11T23:10:47.906074Z","level":"info","event":"\u001b[0m23:10:47","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":106}
{"timestamp":"2025-10-11T23:10:47.918733Z","level":"info","event":"\u001b[0m23:10:47  Completed run in {'account': 'JVQRMFM-GKB40702', 'user': 'sathishthandhari', 'database': 'olist_prod', 'warehouse': 'projects', 'role': 'accountadmin', 'schema': 'staging', 'authenticator': None, 'oauth_client_id': None, 'query_tag': None, 'client_session_keep_alive': False, 'host': None, 'port': None, 'proxy_host': None, 'proxy_port': None, 'protocol': None, 'connect_retries': 1, 'connect_timeout': None, 'retry_on_database_errors': False, 'retry_all': False, 'insecure_mode': False, 'reuse_connections': True, 's3_stage_vpce_dns_name': None, 'type': 'snowflake', 'threads': 8, 'name': 'prod', 'target_name': 'prod', 'profile_name': 'olist_dbt_transformation'} environment","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":106}
{"timestamp":"2025-10-11T23:10:47.923320Z","level":"info","event":"\u001b[0m23:10:47  1 of 1 START hook: olist_dbt_transformation.on-run-end.0 ....................... [RUN]","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":106}
{"timestamp":"2025-10-11T23:10:47.926913Z","level":"info","event":"\u001b[0m23:10:47  1 of 1 OK hook: olist_dbt_transformation.on-run-end.0 .......................... [\u001b[32mOK\u001b[0m in 0.02s]","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":106}
{"timestamp":"2025-10-11T23:10:51.792608Z","level":"info","event":"\u001b[0m23:10:51","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":106}
{"timestamp":"2025-10-11T23:10:51.854911Z","level":"error","event":"Server indicated the task shouldn't be running anymore. Terminating process","detail":{"detail":{"reason":"not_running","message":"TI is no longer in the running state and task should terminate","current_state":"removed"}},"logger":"task"}
{"timestamp":"2025-10-11T23:10:51.800038Z","level":"info","event":"\u001b[0m23:10:51  Finished running 3 project hooks, 8 sources in 0 hours 0 minutes and 12.24 seconds (12.24s).","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":106}
{"timestamp":"2025-10-11T23:10:51.858377Z","level":"info","event":"Sending SIGTERM signal to process group","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":117}
{"timestamp":"2025-10-11T23:10:51.922692Z","level":"info","event":"/usr/python/lib/python3.12/multiprocessing/resource_tracker.py:279: UserWarning: resource_tracker: There appear to be 2 leaked semaphore objects to clean up at shutdown","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":106}
{"timestamp":"2025-10-11T23:10:51.923075Z","level":"info","event":"  warnings.warn('resource_tracker: There appear to be %d '","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":106}
{"timestamp":"2025-10-11T23:10:51.942743Z","level":"info","event":"Command exited with return code -15","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":110}
{"timestamp":"2025-10-11T23:10:51.944291Z","level":"error","event":"Task failed with exception","logger":"task","filename":"task_runner.py","lineno":972,"error_detail":[{"exc_type":"AirflowException","exc_value":"Bash command failed. The command returned a non-zero exit code -15.","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":920,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1302,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":416,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/bash.py","lineno":232,"name":"execute"}],"is_group":false,"exceptions":[]}]}
{"timestamp":"2025-10-11T23:10:51.980400Z","level":"error","event":"Top level error","logger":"task","filename":"task_runner.py","lineno":1457,"error_detail":[{"exc_type":"AirflowRuntimeError","exc_value":"API_SERVER_ERROR: {'status_code': 409, 'message': 'Server returned error', 'detail': {'detail': {'reason': 'invalid_state', 'message': 'TI was not in the running state so it cannot be updated', 'previous_state': 'removed'}}}","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1450,"name":"main"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":999,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/comms.py","lineno":207,"name":"send"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/comms.py","lineno":271,"name":"_get_response"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/comms.py","lineno":258,"name":"_from_frame"}],"is_group":false,"exceptions":[]}]}
{"timestamp":"2025-10-11T23:10:52.009590Z","level":"warning","event":"Process exited abnormally","exit_code":1,"logger":"task"}
{"timestamp":"2025-10-11T23:10:52.011577Z","level":"error","event":"Task killed!","logger":"task"}
